<!-- Chosen Palette: Subtle & Sophisticated -->
<!-- Application Structure Plan: The SPA is redesigned as a professional, persuasive service homepage for HR and business owners. The flow is: Hero (Immediate value prop & CTA) -> Problem (Relatable pain points) -> Solution (Interactive framework demo) -> Service Details (How it works & AI simulation) -> Why Us (Competitive edge & Trust) -> Contact. This structure guides users from problem recognition to solution confirmation, and finally to a clear call-to-action, a classic and effective sales funnel for a B2B service. The interactive elements are strategically placed to engage users and demonstrate the service's value without requiring a conversation. -->
<!-- Visualization & Content Choices: 1. Hero -> Goal: Hook -> Viz: Large text with a button -> Interaction: Scrolls to contact form -> Justification: Provides a strong first impression and clear next step. 2. Problem -> Goal: Empathize -> Viz: Key pain points text with icons -> Interaction: N/A -> Justification: Replaces the chart with relatable, scannable text that directly addresses the user's concerns. 3. Solution -> Goal: Organize/Explain -> Viz: AI Simulator -> Interaction: Input for AI response -> Justification: Makes an abstract concept tangible and demonstrates core service value interactively. 4. Why Us -> Goal: Compare/Persuade -> Viz: Radar Chart & Comparison Table -> Interaction: Toggle radar chart data (now with multi-select) -> Justification: Provides both a visual and a detailed logical comparison to solidify the value proposition. 5. Trust (New) -> Goal: Build Credibility -> Viz: Placeholder for testimonials with image and quote -> Interaction: N/A -> Justification: Essential for B2B sales to show proven success. -->
<!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
<!DOCTYPE html>
<html lang="ja" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>従業員のポテンシャルを引き出すコンサルティング | 公式サイト</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #CAD2C5;
            color: #354F52;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .nav-link.active {
            background-color: #84A98C;
            color: #FFFFFF;
        }
        .nav-link {
            transition: all 0.3s ease;
        }
        .section-card {
            background-color: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #52796F;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .chat-bubble {
            padding: 1rem;
            border-radius: 0.75rem;
            margin-bottom: 0.75rem;
        }
        .chat-bubble.ai {
            background-color: #EBF4F5;
            color: #354F52;
            margin-right: auto;
        }
        .chat-bubble.user {
            background-color: #A3B18A;
            color: #FFFFFF;
            margin-left: auto;
        }
    </style>
</head>
<body class="min-h-screen">

    <div class="md:flex">
        <!-- Sidebar Navigation for Desktop -->
        <nav class="hidden md:block w-64 bg-[#2F3E46] text-white min-h-screen p-4 fixed">
            <h1 class="font-bold text-xl border-b border-gray-500 pb-4">サービスメニュー</h1>
            <ul class="mt-4 space-y-2" id="desktop-nav">
                <li><a href="#hero" class="nav-link block p-3 rounded-lg hover:bg-[#354F52]">トップ</a></li>
                <li><a href="#problem" class="nav-link block p-3 rounded-lg hover:bg-[#354F52]">課題</a></li>
                <li><a href="#solution" class="nav-link block p-3 rounded-lg hover:bg-[#354F52]">私たちの解決策</a></li>
                <li><a href="#simulators" class="nav-link block p-3 rounded-lg hover:bg-[#354F52]">シミュレーター</a></li>
                <li><a href="#services" class="nav-link block p-3 rounded-lg hover:bg-[#354F52]">サービス内容</a></li>
                <li><a href="#edge" class="nav-link block p-3 rounded-lg hover:bg-[#354F52]">なぜ選ばれるのか</a></li>
                <li><a href="#contact" class="nav-link block p-3 rounded-lg hover:bg-[#354F52]">ご相談</a></li>
            </ul>
        </nav>

        <!-- Top Navigation for Mobile -->
        <nav class="md:hidden w-full bg-[#2F3E46] text-white p-2 fixed top-0 z-50 shadow-lg">
            <select id="mobile-nav" class="w-full bg-[#2F3E46] border-0 focus:ring-0 p-2 rounded">
                <option value="#hero">トップ</option>
                <option value="#problem">課題</option>
                <option value="#solution">私たちの解決策</option>
                <option value="#simulators">シミュレーター</option>
                <option value="#services">サービス内容</option>
                <option value="#edge">なぜ選ばれるのか</option>
                <option value="#contact">ご相談</option>
            </select>
        </nav>

        <main class="md:ml-64 flex-1 p-4 md:p-10 mt-16 md:mt-0">
            
            <section id="hero" class="min-h-screen flex items-center justify-center text-center section-container">
                <div class="max-w-3xl">
                    <h2 class="text-4xl md:text-6xl font-bold text-[#2F3E46]">従業員の情熱が、<br class="md:hidden">企業の成長エンジンになる。</h2>
                    <p class="mt-6 text-lg md:text-xl text-[#354F52]">私たちは、従業員一人ひとりの「Will（やりたいこと）」と、会社の「Must（やるべきこと）」を掛け合わせ、働く一人ひとりの情熱を、組織全体の成長へと変えていきます。</p>
                    <a href="#contact" class="mt-8 inline-block bg-[#84A98C] text-white font-bold py-3 px-8 rounded-full shadow-lg hover:bg-[#52796F] transition-colors">無料相談に申し込む</a>
                </div>
            </section>

            <section id="problem" class="py-20 section-container">
                <div class="section-card rounded-xl shadow-lg p-6 md:p-8">
                    <h2 class="text-3xl font-bold text-center mb-4 text-[#2F3E46]">あなたの会社は、こんな課題を抱えていませんか？</h2>
                    <p class="max-w-3xl mx-auto text-center mb-10 text-[#354F52]">従業員のモチベーション低下や離職は、単なる個人の問題ではありません。それは、生産性の低下や採用コストの増大を引き起こし、企業の競争力を著しく損なう経営課題です。これらは多くの場合、従業員の「やりたいこと」と「やるべきこと」が乖離していることに根ざしています。</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="p-6 bg-[#CAD2C5] rounded-lg">
                            <h3 class="font-bold text-xl mb-2 text-[#2F3E46]">📈 優秀な人材が定着しない</h3>
                            <p class="text-sm">高いコストをかけて採用した人材が、早期に退職してしまう。彼らが本当にやりたいことが、今の仕事では実現できないと感じているのかもしれません。</p>
                        </div>
                        <div class="p-6 bg-[#CAD2C5] rounded-lg">
                            <h3 class="font-bold text-xl mb-2 text-[#2F3E46]">🤔 部下のマネジメントに悩んでいる</h3>
                            <p class="text-sm">従来の指示命令型では部下が動かない。一方的な評価ではなく、個々の成長を促す対話のノウハウが求められています。</p>
                        </div>
                        <div class="p-6 bg-[#CAD2C5] rounded-lg">
                            <h3 class="font-bold text-xl mb-2 text-[#2F3E46]">📉 組織全体の生産性が上がらない</h3>
                            <p class="text-sm">社員は真面目に働いている。しかし、組織の目標と個人の目標がバラバラで、ベクトルが揃わず、大きな成果に結びつきません。</p>
                        </div>
                        <div class="p-6 bg-[#CAD2C5] rounded-lg">
                            <h3 class="font-bold text-xl mb-2 text-[#2F3E46]">💸 高額なコンサルティングは非現実的</h3>
                            <p class="text-sm">人材育成の重要性は理解しているものの、大手コンサルティングファームのサービスは費用が高く、中小企業やスタートアップには手の届かない存在です。</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="solution" class="py-20 section-container">
                <div class="section-card rounded-xl shadow-lg p-6 md:p-8">
                    <h2 class="text-3xl font-bold text-center mb-4 text-[#2F3E46]">Will-Can-Mustで、本質的な課題を解決する</h2>
                    <p class="max-w-3xl mx-auto text-center mb-10">私たちは、リクルート発祥の実践的な「Will（やりたいこと）」、「Can（できること）」、「Must（すべきこと）」という3つの要素を構造的に整理し、個人のパフォーマンスと組織の成長を両立させるフレームワークを中核に据えています。このフレームワークを軸に、以下のサービスで人と組織の本質的な課題を解決します。</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-12">
                        <div class="p-6 bg-[#CAD2C5] rounded-lg">
                            <h3 class="font-bold text-xl mb-2 text-[#2F3E46]">従業員向け：個別1on1コーチング</h3>
                            <p class="text-sm">従業員一人ひとりの「Will（やりたいこと）」を言語化し、「Must（すべきこと）」との接続点を共に探求します。「Will-Can-Must」のワークシートを活用した個別セッションを通じて、個人のキャリア願望や強みを整理し、内発的動機を高めます。</p>
                        </div>
                        <div class="p-6 bg-[#CAD2C5] rounded-lg">
                            <h3 class="font-bold text-xl mb-2 text-[#2F3E46]">上長・人事部向け：マネジメントトレーニング</h3>
                            <p class="text-sm">上長が効果的な1on1を実施し、部下の内発的動機を引き出すスキルを習得するトレーニングです。傾聴やフィードバックの技術を実践的に学び、ツールだけでは解決できない「対話の質の向上」という本質的な課題を解決します。</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="simulators" class="py-20 section-container">
                <div class="section-card rounded-xl shadow-lg p-6 md:p-8">
                    <h2 class="text-3xl font-bold text-center mb-10 text-[#2F3E46]">✨ 2つのAIシミュレーターを体験する ✨</h2>
                    <p class="text-center mb-12 max-w-3xl mx-auto">サービスの価値を、ぜひご自身で体感してください。従業員の悩み、上司の悩みに合わせた2つのシミュレーターをご用意しました。</p>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                        <!-- Will-Must ギャップ分析シミュレーター -->
                        <div>
                            <h3 class="text-xl font-bold text-center mb-4 text-[#2F3E46]">従業員用: Will-Must ギャップ分析</h3>
                            <p class="text-center mb-6 text-[#354F52]">あなたの「Will」と「Must」を入力してください。AIがギャップを分析し、解決策を提案します。</p>
                            <div class="space-y-4">
                                <div>
                                    <label for="willInput" class="block font-bold mb-2">あなたの「Will」（やりたいこと）</label>
                                    <textarea id="willInput" class="w-full p-3 rounded-lg border border-gray-300 bg-white" rows="4" placeholder="例：チームをまとめ、新しいプロジェクトを成功させたい"></textarea>
                                </div>
                                <div>
                                    <label for="mustInput" class="block font-bold mb-2">組織の「Must」（やるべきこと）</label>
                                    <textarea id="mustInput" class="w-full p-3 rounded-lg border border-gray-300 bg-white" rows="4" placeholder="例：既存顧客のサポート業務で、売上を20%向上させること"></textarea>
                                </div>
                            </div>
                            <div class="text-center mt-6">
                                <button id="analyzeButton" class="bg-[#84A98C] text-white font-bold py-3 px-8 rounded-full shadow-lg hover:bg-[#52796F] transition-colors">AIに分析を依頼</button>
                            </div>
                            <div id="loading" class="hidden flex justify-center mt-8">
                                <div class="loading-spinner"></div>
                            </div>
                            <div id="analysisResult" class="mt-8 p-6 bg-white rounded-lg shadow-inner hidden">
                                <h4 class="font-bold text-[#52796F] mb-2">💡 AIからの分析結果</h4>
                                <div id="analysisChatbox" class="space-y-4"></div>
                                <div id="analysisFollowup" class="mt-4 pt-4 border-t border-[#CAD2C5] hidden">
                                    <label for="followupInput" class="block font-bold mb-2 text-[#354F52]">さらに壁打ちしてみましょう</label>
                                    <textarea id="followupInput" class="w-full p-3 rounded-lg border border-gray-300 bg-white" rows="2" placeholder="例：具体的なステップの例をもう少し詳しく教えてください。"></textarea>
                                    <div class="text-center mt-4">
                                        <button id="followupButton" class="bg-[#A3B18A] text-white font-bold py-2 px-6 rounded-full hover:bg-[#84A98C] transition-colors">質問する</button>
                                    </div>
                                    <div id="followupLoading" class="hidden flex justify-center mt-4">
                                        <div class="loading-spinner"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 1on1 対話シミュレーター -->
                        <div>
                            <h3 class="text-xl font-bold text-center mb-4 text-[#2F3E46]">マネジメント層用: 1on1 対話シミュレーター</h3>
                            <p class="text-center mb-6 text-[#354F52]">部下からの相談内容を入力すると、AIが「Will-Can-Must」の観点から適切な問いかけを提案します。</p>
                            <div class="max-w-2xl mx-auto">
                                <label for="dialogueInput" class="block font-bold mb-2">部下からの相談内容</label>
                                <textarea id="dialogueInput" class="w-full p-3 rounded-lg border border-gray-300 bg-white" rows="4" placeholder="例：最近、仕事へのモチベーションが上がらず、日々の業務が退屈に感じてしまいます。"></textarea>
                            </div>
                            <div class="text-center mt-6">
                                <button id="dialogueButton" class="bg-[#84A98C] text-white font-bold py-3 px-8 rounded-full shadow-lg hover:bg-[#52796F] transition-colors">AIに問いかけを依頼</button>
                            </div>
                            <div id="dialogueLoading" class="hidden flex justify-center mt-8">
                                <div class="loading-spinner"></div>
                            </div>
                            <div id="dialogueResult" class="mt-8 p-6 bg-white rounded-lg shadow-inner hidden">
                                <h4 class="font-bold text-[#52796F] mb-2">💡 AIからの問いかけ例</h4>
                                <div id="dialogueText"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="services" class="py-20 section-container">
                <div class="section-card rounded-xl shadow-lg p-6 md:p-8">
                    <h2 class="text-3xl font-bold text-center mb-10 text-[#2F3E46]">サービス導入後のフロー</h2>
                    <p class="max-w-3xl mx-auto text-center mb-10">私たちは、従業員個人と組織の両方に働きかけるハイブリッドなサービスで、本質的な課題解決をサポートします。貴社の課題に合わせて、個別コーチングとマネジメントトレーニングを単独または並行で実施できます。</p>
                    <div class="relative max-w-4xl mx-auto">
                        <div class="border-l-4 border-[#84A98C] pl-8 space-y-12">
                            <div class="flex items-start">
                                <div class="bg-[#84A98C] text-white rounded-full h-8 w-8 flex-shrink-0 flex items-center justify-center font-bold relative -left-4 top-0">1</div>
                                <div class="ml-4">
                                    <h3 class="text-xl font-bold mb-2">ヒアリング・現状分析</h3>
                                    <p class="text-[#354F52]">貴社の組織文化や人材育成の現状、経営層が抱える課題を深くヒアリングします。これにより、サービスをカスタマイズするための土台を築きます。</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div class="bg-[#84A98C] text-white rounded-full h-8 w-8 flex-shrink-0 flex items-center justify-center font-bold relative -left-4 top-0">2</div>
                                <div class="ml-4">
                                    <h3 class="text-xl font-bold mb-2">サービス実施（個別コーチング & マネジメントトレーニング）</h3>
                                    <p class="text-[#354F52]">ステップ1で策定したプランに基づき、従業員向けの個別コーチングと上長向けのマネジメントトレーニングを並行して実施します。これにより、両軸から組織変革を促進します。</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div class="bg-[#84A98C] text-white rounded-full h-8 w-8 flex-shrink-0 flex items-center justify-center font-bold relative -left-4 top-0">3</div>
                                <div class="ml-4">
                                    <h3 class="text-xl font-bold mb-2">成果の可視化とフィードバック</h3>
                                    <p class="text-[#354F52]">サービス実施後の従業員のエンゲージメント変化を定期的に測定し、成果をレポートとして提出します。これにより、投資対効果を明確に把握できます。</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="case-study" class="py-20 section-container">
                <div class="section-card rounded-xl shadow-lg p-6 md:p-8">
                    <h2 class="text-3xl font-bold text-center mb-10 text-[#2F3E46]">お客様の声・導入事例</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="p-6 bg-[#CAD2C5] rounded-lg text-center">
                            <p class="italic text-[#354F52] mb-4">"導入後、従業員のエンゲージメントスコアが15%向上しました。これまで個人の問題として片付けていたモチベーションの課題が、組織全体で解決できると確信しました."</p>
                            <p class="font-bold text-[#2F3E46]">- 〇〇社 人事部長</p>
                        </div>
                        <div class="p-6 bg-[#CAD2C5] rounded-lg text-center">
                            <p class="italic text-[#354F52] mb-4">"個々のキャリア願望に耳を傾けることで、チーム全体のパフォーマンスが劇的に改善。私たちの成長に欠かせないパートナーです。"</p>
                            <p class="font-bold text-[#2F3E46]">- 〇〇社 経営者</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="edge" class="py-20 section-container">
                <div class="section-card rounded-xl shadow-lg p-6 md:p-8">
                    <h2 class="text-3xl font-bold text-center mb-10 text-[#2F3E46]">なぜ、私たちのサービスが選ばれるのか</h2>
                    <p class="max-w-3xl mx-auto text-center mb-10">私たちは、高額な大手コンサルティングや、ツール導入だけでは解決できない、人と組織の「本質的な課題」にフォーカスします。以下で他社との違いをご覧ください。</p>
                    
                    <div class="chart-container mb-12">
                        <canvas id="competitorRadarChart"></canvas>
                    </div>

                    <div class="overflow-x-auto">
                        <table class="w-full text-left table-auto border-collapse">
                            <thead>
                                <tr class="bg-[#CAD2C5]">
                                    <th class="p-4 border border-[#84A98C] font-bold text-[#2F3E46] min-w-[120px] text-center">項目</th>
                                    <th class="p-4 border border-[#84A98C] font-bold text-[#2F3E46] text-center">本事業</th>
                                    <th class="p-4 border border-[#84A98C] font-bold text-[#2F3E46] text-center">大手コンサル</th>
                                    <th class="p-4 border border-[#84A98C] font-bold text-[#2F3E46] text-center">1on1ツール</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="bg-white">
                                    <td class="p-4 border border-[#CAD2C5] font-bold">サービス内容</td>
                                    <td class="p-4 border border-[#CAD2C5]">個別1on1、マネジメント研修</td>
                                    <td class="p-4 border border-[#CAD2C5]">全社的な人事制度設計、組織戦略</td>
                                    <td class="p-4 border border-[#CAD2C5]">1on1の記録・目標管理SaaS</td>
                                </tr>
                                <tr class="bg-gray-50">
                                    <td class="p-4 border border-[#CAD2C5] font-bold">主な価値</td>
                                    <td class="p-4 border border-[#CAD2C5]">人材育成、内発的動機付け</td>
                                    <td class="p-4 border border-[#CAD2C5]">組織変革、制度構築</td>
                                    <td class="p-4 border border-[#CAD2C5]">運用効率化、情報集約</td>
                                </tr>
                                <tr class="bg-white">
                                    <td class="p-4 border border-[#CAD2C5] font-bold">ターゲット</td>
                                    <td class="p-4 border border-[#CAD2C5]">中小企業、スタートアップ</td>
                                    <td class="p-4 border border-[#CAD2C5]">大企業、中堅企業</td>
                                    <td class="p-4 border border-[#CAD2C5]">すべての企業規模</td>
                                </tr>
                                <tr class="bg-gray-50">
                                    <td class="p-4 border border-[#CAD2C5] font-bold">費用感</td>
                                    <td class="p-4 border border-[#CAD2C5]">中〜低額</td>
                                    <td class="p-4 border border-[#CAD2C5]">高額（年1億〜）</td>
                                    <td class="p-4 border border-[#CAD2C5]">低額（月額数百円/人）</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="faq" class="py-20 section-container">
                <div class="section-card rounded-xl shadow-lg p-6 md:p-8 max-w-2xl mx-auto">
                    <h2 class="text-3xl font-bold text-center mb-10 text-[#2F3E46]">よくあるご質問</h2>
                    <div class="space-y-4">
                        <div class="border-b border-[#CAD2C5] pb-4">
                            <h3 class="font-bold text-lg mb-1">Q. 従業員数が多い場合でも対応可能ですか？</h3>
                            <p class="text-[#354F52]">A. はい、可能です。大規模な組織の場合でも、フェーズを分けて導入するなど、貴社の状況に合わせた最適なプランをご提案します。まずはご相談ください。</p>
                        </div>
                        <div class="border-b border-[#CAD2C5] pb-4">
                            <h3 class="font-bold text-lg mb-1">Q. 研修はオンラインでも実施できますか？</h3>
                            <p class="text-[#354F52]">A. はい、オンラインでの研修・コーチングにも対応しております。場所を問わず、全国の企業様にご利用いただけます。</p>
                        </div>
                        <div class="border-b border-[#CAD2C5] pb-4">
                            <h3 class="font-bold text-lg mb-1">Q. 費用について教えてください。</h3>
                            <p class="text-[#354F52]">A. 料金は、プロジェクトの規模や期間、人数に応じて変動いたします。まずはヒアリングをさせていただき、最適なプランと明確なお見積もりをご提示します。</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="contact" class="py-20 section-container">
                <div class="section-card rounded-xl shadow-lg p-6 md:p-8 max-w-2xl mx-auto text-center">
                    <h2 class="text-3xl font-bold text-[#2F3E46] mb-4">無料相談に申し込む</h2>
                    <p class="text-lg text-[#354F52] mb-6">従業員エンゲージメントの向上、マネジメントスキルの強化、離職率の改善など、貴社が抱える人材育成の課題について、まずはお気軽にご相談ください。専門のコンサルタントが、貴社だけの最適な解決策を共に考えます。</p>
                    <a href="#" class="inline-block bg-[#84A98C] text-white font-bold py-3 px-8 rounded-full shadow-lg hover:bg-[#52796F] transition-colors">無料相談に申し込む</a>
                    <p class="text-xs text-gray-500 mt-4">※架空のサービスです。このボタンは機能しません。</p>
                </div>
            </section>

        </main>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const GEMINI_API_URL = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=";
    const apiKey = "";
    const headers = { 'Content-Type': 'application/json' };
    
    const sections = document.querySelectorAll('.section-container');
    const navLinks = document.querySelectorAll('.nav-link');
    const mobileNav = document.getElementById('mobile-nav');

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const id = entry.target.getAttribute('id');
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === `#${id}`) {
                        link.classList.add('active');
                    }
                });
                mobileNav.value = `#${id}`;
            }
        });
    }, { rootMargin: '-50% 0px -50% 0px' });

    sections.forEach(section => observer.observe(section));
    
    mobileNav.addEventListener('change', (e) => {
        window.location.href = e.target.value;
    });

    let analysisChatHistory = [];

    const analyzeButton = document.getElementById('analyzeButton');
    const willInput = document.getElementById('willInput');
    const mustInput = document.getElementById('mustInput');
    const analysisResult = document.getElementById('analysisResult');
    const analysisChatbox = document.getElementById('analysisChatbox');
    const loading = document.getElementById('loading');
    const analysisFollowup = document.getElementById('analysisFollowup');
    const followupInput = document.getElementById('followupInput');
    const followupButton = document.getElementById('followupButton');
    const followupLoading = document.getElementById('followupLoading');

    const addMessageToChatbox = (text, sender) => {
        const messageDiv = document.createElement('div');
        messageDiv.classList.add('chat-bubble');
        if (sender === 'user') {
            messageDiv.classList.add('chat-bubble', 'user');
        } else {
            messageDiv.classList.add('chat-bubble', 'ai');
        }
        messageDiv.innerHTML = text.replace(/\n/g, '<br>');
        analysisChatbox.appendChild(messageDiv);
        analysisChatbox.scrollTop = analysisChatbox.scrollHeight;
    };

    const callGeminiApi = async (messages, callback) => {
        const payload = { contents: messages };
        if (!apiKey) {
            console.log("APIキーが設定されていません。デモ機能が有効になります。");
            const dummyResponses = {
                'initial': '素晴らしいWillとMustをお持ちですね。この2つの間には、情熱を具体的な行動に繋げるための道筋というギャップがあります。まずは「Must」の中で「Will」に繋がる小さな一歩を見つけ、実行してみましょう。それが大きな変化へと繋がりますよ。',
                'followup': 'その問いかけはとても重要です。具体的なステップとしては、まず上司と「Will」について共有することから始めましょう。次に、その「Will」を活かせる業務のアイデアを3つほど考えてみてください。それが次の対話のきっかけになります。'
            };
            const isInitial = messages.length === 1;
            const text = isInitial ? dummyResponses.initial : dummyResponses.followup;
            setTimeout(() => callback(text), 1500);
            return;
        }
        try {
            const response = await fetch(GEMINI_API_URL + apiKey, {
                method: 'POST',
                headers: headers,
                body: JSON.stringify(payload)
            });
            const result = await response.json();
            const text = result.candidates[0].content.parts[0].text;
            callback(text);
        } catch (error) {
            console.error("API call failed:", error);
            callback("エラーが発生しました。もう一度お試しください。");
        }
    };

    analyzeButton.addEventListener('click', async () => {
        const willContent = willInput.value;
        const mustContent = mustInput.value;
        if (!willContent || !mustContent) return;

        analysisResult.classList.add('hidden');
        loading.classList.remove('hidden');
        analysisChatHistory = [];
        analysisChatbox.innerHTML = '';

        const initialUserPrompt = `あなたは人事コンサルタントとして、クライアントの「Will（やりたいこと）」と「Must（やるべきこと）」に関する悩みに寄り添い、具体的なアドバイスを提供します。まず、クライアントのWillとMustを深く理解した上で、そのギャップを温かく、人間らしい言葉で説明してください。次に、このギャップを「現在の会社内で」埋めるための具体的なステップをいくつか提案し、前向きな行動を促してください。転職や異動など、環境を変えることを直接的に示唆するアドバイスは絶対に避けてください。Will: ${willContent} Must: ${mustContent}`;

        analysisChatHistory.push({ role: "user", parts: [{ text: initialUserPrompt }] });
        
        await callGeminiApi(analysisChatHistory, (text) => {
            addMessageToChatbox(text, 'ai');
            analysisChatHistory.push({ role: "model", parts: [{ text: text }] });
            loading.classList.add('hidden');
            analysisResult.classList.remove('hidden');
            analysisFollowup.classList.remove('hidden');
        });
    });

    followupButton.addEventListener('click', async () => {
        const userQuestion = followupInput.value;
        if (!userQuestion) return;

        addMessageToChatbox(userQuestion, 'user');
        followupInput.value = '';
        followupLoading.classList.remove('hidden');

        const followupPrompt = `これまでの対話を踏まえ、以下の追加の質問に答えてください。引き続き、あなたの役割は「現在の会社内でWillとMustを結びつける方法をアドバイスする温かい人事コンサルタント」です。転職や部署異動を促すような回答は絶対にしないでください。質問: ${userQuestion}`;

        analysisChatHistory.push({ role: "user", parts: [{ text: followupPrompt }] });

        await callGeminiApi(analysisChatHistory, (text) => {
            addMessageToChatbox(text, 'ai');
            analysisChatHistory.push({ role: "model", parts: [{ text: text }] });
            followupLoading.classList.add('hidden');
        });
    });

    // LLM Integration for Dialogue Simulation
    const dialogueButton = document.getElementById('dialogueButton');
    const dialogueInput = document.getElementById('dialogueInput');
    const dialogueResult = document.getElementById('dialogueResult');
    const dialogueText = document.getElementById('dialogueText');
    const dialogueLoading = document.getElementById('dialogueLoading');

    dialogueButton.addEventListener('click', async () => {
        const problemContent = dialogueInput.value;
        if (!problemContent) return;
        
        dialogueResult.classList.add('hidden');
        dialogueLoading.classList.remove('hidden');
        
        const payload = {
            contents: [{
                parts: [{ text: `あなたは人事コンサルタントとして、上司が部下と話す際に役立つアドバイスを提供します。以下の部下からの相談内容に対し、離職防止の観点から、部下のWill（やりたいこと）を今の会社や部署のMust（やるべきこと）に結びつけるための、具体的な問いかけを複数提案してください。この対話の目的は、部下のWillを現在の環境でどう実現するかを共に考えることです。転職や異動など、環境を変えることを直接的に示唆するアドバイスは避けてください。話し方は優しく、部下が安心して話せるような、共感的なトーンを心がけてください。相談内容：${problemContent}` }]
            }]
        };

        if (!apiKey) {
            console.log("APIキーが設定されていません。デモ機能が有効になります。");
            const dummyResponse = `「最近、仕事が退屈なんですね。話してくれてありがとう。そう感じてしまう背景をもう少し聞かせてもらってもいいですか？」と、まずは丁寧に話を聞く姿勢を示しましょう。\n\nその上で、以下の問いかけを試してみてください。\n\n1.「これまでの仕事で、どんな時に一番ワクワクしたり、楽しいと感じましたか？」\n→部下の「Will」のヒントを探ります。\n\n2.「そのワクワク感を、今の仕事や会社のどんな部分で活かせそうだと思いますか？」\n→部下のWillと会社のMustを繋ぐ接点を一緒に考えます。\n\n3.「今後、どんなスキルを身につけたら、そのワクワク感がもっと深まると思いますか？」\n→部下の「Can」を強化するための具体的な行動を促します。`;
            setTimeout(() => {
                dialogueText.innerHTML = dummyResponse.replace(/\n/g, '<br>');
                dialogueResult.classList.remove('hidden');
                dialogueLoading.classList.add('hidden');
            }, 1500);
            return;
        }

        try {
            const response = await fetch(GEMINI_API_URL + apiKey, {
                method: 'POST',
                headers: headers,
                body: JSON.stringify(payload)
            });
            const result = await response.json();
            const text = result.candidates[0].content.parts[0].text;
            dialogueText.innerHTML = text.replace(/\n/g, '<br>');
            dialogueResult.classList.remove('hidden');
        } catch (error) {
            console.error("Dialogue simulation failed:", error);
            dialogueText.textContent = "シミュレーション中にエラーが発生しました。もう一度お試しください。";
            dialogueResult.classList.remove('hidden');
        } finally {
            dialogueLoading.classList.add('hidden');
        }
    });

    const competitorDescriptions = {
        '本事業': '「対話の質」と「個人の内発的動機」に特化。個別対応力と導入しやすさを両立し、中小企業に最適なソリューションを提供します。',
        '大手コンサル': '全社的な人事制度設計や組織戦略に強み。高度な戦略を提供する一方、費用は高額で、個別の対話の質向上には直接的に寄与しにくい側面があります。',
        '1on1支援ツール': '運用効率化と情報集約に価値を発揮。低価格で導入しやすいですが、対話スキルそのものを向上させる機能はなく、効果は上長のスキルに依存します。'
    };

    const radarChart = new Chart(document.getElementById('competitorRadarChart').getContext('2d'), {
        type: 'radar',
        data: {
            labels: ['個別対応力', '対話の質向上', '導入しやすさ', '価格の手頃さ', '制度設計力'],
            datasets: [
                { label: '本事業', data: [5, 5, 4, 4, 3], borderColor: '#006400', backgroundColor: 'rgba(0, 100, 0, 0.2)', borderWidth: 2, pointBackgroundColor: '#006400' },
                { label: '大手コンサル', data: [3, 2, 2, 1, 5], borderColor: '#8B0000', backgroundColor: 'rgba(139, 0, 0, 0.2)', borderWidth: 2, pointBackgroundColor: '#8B0000' },
                { label: '1on1支援ツール', data: [2, 1, 5, 5, 1], borderColor: '#4B0082', backgroundColor: 'rgba(75, 0, 130, 0.2)', borderWidth: 2, pointBackgroundColor: '#4B0082' }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: { r: { suggestedMin: 0, suggestedMax: 5, pointLabels: { font: { size: 12 } }, ticks: { backdropColor: 'transparent' } } },
            plugins: {
                legend: {
                    position: 'top',
                    onClick: (e, legendItem, legend) => {
                        const index = legendItem.datasetIndex;
                        const ci = legend.chart;
                        
                        const dataset = ci.data.datasets[index];
                        dataset.hidden = !dataset.hidden;
                        ci.update();
                    }
                }
            }
        }
    });
});
</script>
</body>
</html>
